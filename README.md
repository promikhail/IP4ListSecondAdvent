# Решение задачи приведенной в [файле](./TASK.md)

## Генератор файла с айпи адресами для тестирования анализатора

Проект [Generator](./generator) позволяет генерировать текстовые файлы
со списком рандомных IP адресов разделенных переносом строки.
Требуемое количество адресов можно задать в main
в переменной `ipCount`. Можно задать тип переноса строк CRLF/LF
через переменную `isCrLf`.

Сгенерированный файл сохраняется в папке [files](./files).
Туда же кладется файл со статистикой количества повторов айпи адресов.

## Анализатор файла с айпи адресами

Проект [Analyzer](./analyzer) позволяет анализировать большие текстовые файлы
содержащие IP адресов разделенных переносом строки.
Поддерживаются разделители `LF` и `CRLF`.

Для работы анализатора требуется только 528 МБ оперативной памяти.

512 МБ (на массив) + 16 МБ (др ресурсы) = 528 МБ

### Принцип работы анализатора

Анализатор применяет массив битов (BitSet) для учета наличия айпи адресов.
Так как по задаче требуется только определить количество уникальных,
т.е. адресов встречающихся в файле, нам нужно считать только до 1:
0 - не встречается, 1 - встречается один и более раз.
Для этого нам достаточно хранить счетчик в 1 бите.

Анализатор для ускорения логически делит файл на куски и обрабатывает каждую
в разных потоках. Потоки считывают строки с айпи адресами и преобразуют их
в Int значение. Это значение выступает в качестве индекса в массиве,
указывает на 1 бит в массиве. На каждый айпи адрес производится установка
значения бита в 1 в массиве согласно Int индексу.

После прохода всего файла, делается подсчет количества уникальных айпи адресов,
путем определения количества в массиве битов со значением 1.

# Результаты тестового запуска

Максимальный размер кучи: 536МБ (-Xmx536M) \
Исходный файл 42.6 ГБ (45_843_685_941 байт) \
Количество IP адресов: 3 миллиарда строк \
Анализ занял время: 1972 сек (32 мин 52 сек) \
Анализ массива занял время: 40 сек.

Максимальный размер кучи: 536МБ (-Xmx536M) \
Исходный файл: 66.5 ГБ (71_406_206_674 байт) \
Количество IP адресов: 5 миллиардов строк \
Анализ занял время: 2261 сек (37 мин 41 сек) \
Анализ массива занял время: 33 сек.
